# 搜索功能说明

## 功能概述

为 AI 对话应用添加了强大的搜索功能，类似于 ChatGPT 的搜索体验。用户可以快速搜索历史对话内容并导航到相关对话。

## 功能特性

### 🔍 搜索能力
- **全文搜索**: 支持对话标题和消息内容的模糊匹配
- **实时搜索**: 输入关键词后自动触发搜索（500ms 防抖）
- **分页支持**: 支持搜索结果分页浏览
- **高亮显示**: 搜索关键词在结果中高亮显示

### ⌨️ 交互体验
- **键盘快捷键**: `Ctrl+K` (Windows) 或 `Cmd+K` (Mac) 快速打开搜索
- **ESC 关闭**: 按 ESC 键快速关闭搜索对话框
- **自动聚焦**: 打开搜索对话框时自动聚焦到输入框
- **回车搜索**: 在输入框中按回车键执行搜索

### 📱 UI/UX 设计
- **现代化界面**: 使用 shadcn-vue 组件，界面美观统一
- **响应式设计**: 适配不同屏幕尺寸
- **加载状态**: 搜索过程中显示加载动画
- **空状态提示**: 无搜索结果时显示友好提示

## 使用方法

### 1. 打开搜索
- 点击侧边栏的 "Search" 按钮
- 使用键盘快捷键 `Ctrl+K` 或 `Cmd+K`

### 2. 执行搜索
- 在搜索框中输入关键词
- 系统会自动执行搜索（防抖延迟 500ms）
- 也可以按回车键立即执行搜索

### 3. 查看结果
搜索结果显示以下信息：
- 对话标题
- AI 模型名称
- 消息角色（用户/AI助手）
- 消息内容预览（关键词高亮）
- 消息时间

### 4. 导航到对话
- 点击任意搜索结果
- 自动跳转到对应的对话详情页面
- 搜索对话框自动关闭

## 技术实现

### 组件结构
```
SearchDialog.vue          # 主搜索对话框组件
├── shadcn-vue Dialog     # 对话框容器
├── Input                 # 搜索输入框
├── Badge                 # 模型标签
├── Avatar               # 角色头像
└── Button               # 分页按钮
```

### API 集成
- **搜索接口**: `GET /api/v1/conversations/search`
- **认证**: 使用 JWT Token 认证
- **参数**: keyword（关键词）、current（页码）、size（页大小）
- **响应**: 分页搜索结果，包含匹配的对话和消息

### 状态管理
- 使用 Vue 3 Composition API
- 响应式搜索状态管理
- 防抖优化减少 API 请求
- 分页状态维护

## 搜索规则

1. **搜索范围**: 搜索用户的所有历史对话消息和对话标题
2. **匹配方式**: 模糊匹配，支持部分关键词匹配
3. **权限控制**: 只能搜索当前用户的对话
4. **排序规则**: 按消息创建时间倒序排列
5. **状态过滤**: 自动过滤已删除的对话

## 快捷键列表

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+K` / `Cmd+K` | 打开搜索对话框 |
| `Enter` | 执行搜索 |
| `ESC` | 关闭搜索对话框 |

## 示例场景

### 查找特定话题
```
搜索: "介绍你自己"
结果: 显示所有包含该关键词的对话
```

### 查找特定时间段的对话
搜索结果按时间排序，可以通过时间标识快速定位特定时间段的对话。

### 查找使用特定模型的对话
每个搜索结果都显示使用的 AI 模型，便于筛选特定模型的对话。

## 性能优化

1. **防抖搜索**: 避免频繁 API 请求
2. **分页加载**: 减少单次数据传输量
3. **关键词高亮**: 客户端实现，提升响应速度
4. **缓存优化**: 搜索结果可以进行适当缓存

## 后续扩展

可以考虑以下功能扩展：
- 高级搜索（按时间、模型、角色筛选）
- 搜索历史记录
- 搜索结果导出
- 全键盘导航支持
- 搜索建议/自动完成
